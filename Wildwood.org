** Measurements

- I'm measuring everything using feet with a decimal point up to thousanth
  of a foot, I now that this is too many significant digits but I figure
  I might as well record the precision given to me my the laser tool and
  assume it will all even out in the end.
- When measuring doors I'm measuring to the opening and windows I'm
  measuring to the glass or the interior frame, in both cases trim is
  ignored.

** GUI

- Mostly text-based
- When you press a key it highlights the GUI part and names it
- Click on point and it highlights it and gives the reference name ready to be pasted
- Same with clicking on place where we want a point    

** Floor plan slices, extrude up until the slice is different

We will start with the floor pretending that the doors don't exist so
there will be openings there. Then we extrude up until we hit the
lowest window, then the slice changes and we extrude up again until
we get to a new slice, and on and on.

We should be able to use anything to generate the slices, not just
OpenSCAD.

#+name: compile
#+begin_src elisp
(org-babel-tangle)
(org-sbe run-metapost)
#+end_src

#+name: run-metapost
#+begin_src sh :results output
which mpost
cd output
pwd
#mpost --mem=metafun drawing.mp || cat drawing.log
#open -a Safari drawing.svg
context drawing.tex
#+end_src

#+begin_src metapost :tangle output/drawing.mp :noweb yes
outputtemplate := "%j.%o";
outputformat := "svg";
beginfig(0);
  <<wildwood>>
endfig;
end.
#+end_src


#+begin_src tex :tangle output/drawing.tex :noweb yes
        
\definefont[bahnlight][name:bahnschriftlight*default]
\definefont[dim][name:bahnschriftlight*default at 5pt]
\definefont[title][name:bahnschrift*default at 25pt]
                                            
\definepapersize [biggy] [width=550mm,height=230mm]
\setuppapersize[biggy]

\starttext
\setuppagenumbering[location=]
\bahnlight
\startMPcode{decimalfun}
  <<wildwood>>
\stopMPcode
\stoptext
#+end_src


We can draw a single point from a path like this:

  draw point 2 of garage withpen pencircle scaled 4bp;

#+name: wildwood
#+begin_src metapost
input TEX;
linecap := butt;
linejoin := mitered;

def drawwall (expr p, thickness) =
  pickup pencircle scaled (thickness*2);
  draw p withcolor .8 white;
  unfill p;
enddef;

def drawinterior (expr p) =
  pickup pencircle scaled 1bp;
  draw p;
enddef;

def doorup    (expr p, offset, length) = (p+(0,offset))--(p+(0,offset+length)); enddef;
def doordown  (expr p, offset, length) = (p-(0,offset))--(p-(0,offset+length)); enddef;
def doorright (expr p, offset, length) = (p+(offset,0))--(p+(offset+length,0)); enddef;
def doorleft  (expr p, offset, length) = (p-(offset,0))--(p-(offset+length,0)); enddef;

% v is the vector to the outside
def drawwindow (expr p, v) =
  undraw p;
  draw p shifted ((th/2)    * xpart v,   (th/2) * ypart v) withpen pencircle scaled .5bp;
  draw p shifted ((th-.5bp) * xpart v,(th-.5bp) * ypart v) withpen pencircle scaled .5bp;
enddef;

def drawdimension(expr p, offset) =
  pickup pencircle scaled .7bp;
  drawdblarrow p shifted offset shortened 1.75bp;
  picture pic;
  l := arclength p;
  if (floor(l mod 12) = 0):
    pic := thelabel("\dim " & decimal(floor(l / 12)) & "' ", point 1/2 of p shifted offset);
  else:
    pic := thelabel("\dim " & decimal(floor(l / 12)) & "'" & decimal(floor(l mod 12)), point 1/2 of p shifted offset);
  fi
  unfill bbox pic;
  draw pic;
enddef;

primarydef pct along pat = % This was taken from from MetaFun's macros
  (arctime (pct * (arclength pat)) of pat) of pat
enddef;

ft = 12bp;
EstFt = 12bp; % Estimated feet, need to re-measure these dimensions
TODO = 0bp; % Unknown
th := 0.445 EstFt; % Interior wall thickness 

% L I V I N G  ---  K I T C H E N  ---   E N T R Y

A :=  4.090 ft;     AA := 23.070 ft;     BA :=  3.330 ft;    
B :=  8.095 ft;     AB :=  4.925 ft;     BB := 23.065 ft;
C := 18.530 ft;     AC := 10.580 ft;     BC := 19.190 ft;
D := 43.530 ft;     AD := 14.840 ft;     BD :=  2.410 ft;
E :=  8.550 ft;     AE :=  3.080 ft;     BE := 10.080 ft;
F :=  5.420 ft;     AF := 17.730 ft;     BF :=  2.415 ft;
G :=  3.015 ft;     AG := 12.52EstFt;    BG :=  3.115 ft;
H :=  1.910 ft;     AH := 14.890 ft;     BH :=  7.690 ft;
I :=  0.330 ft;     AI :=  5.690 ft;     BI := 15.470 ft;
J := 12.525 ft;     AJ :=  4.435 ft;     BJ :=  3.365 ft;
K := 15.975 ft;     AK :=  6.040 ft;     BK :=  3.985 ft;
L :=  2.155 ft;     AL :=  4.385 ft;     BL :=  6.900 ft;
M :=  7.950 ft;     AM :=  1.475 ft;     BM :=  1.220 ft;
N := 10.920 ft;     AN := 38.520 ft;     BN :=  4.900 ft;
O := 15.855 ft;                          BO :=  4.740 ft;
P := 17.110 ft;                          BP :=  6.400 ft;
Q := 22.905 ft;                          BQ :=  3.315 ft;
R := 24.460 ft;                          BR :=  2.400 ft;
S :=  1.355 ft;                          
T := 10.500 ft;                          
U :=  0.615 ft;                          
V :=  3.930 ft;
W :=  9.990 ft;
X := 15.975 ft;
Y :=  2.670 ft;

% L A U N D R Y --- S M A L L B E D  --- S O U T H B E D  --- M A S T E R
DA := 2.620 ft;     EA := 12.000 ft;     FA := 12.295 ft;     JA := 12.435 ft;
DB := 5.375 ft;     EB :=  7.370 ft;     FB := 15.170 ft;     JB :=  4.315 ft;
DC := 8.725 ft;     EC :=  3.550 ft;     FC :=  5.395 ft;     JC :=  4.960 ft;
DD := 8.070 ft;     ED := 14.900 ft;     FD :=  3.600 ft;     JD := 16.500 ft;
DE := 3.490 ft;     EE :=  1.135 ft;     FE :=  3.835 ft;     JE := 19.405 ft;
DF := 2.685 ft;     EF :=  4.630 ft;     FF :=  7.375 ft;     JF :=  1.490 ft;
DG := 2.915 ft;     EG :=  2.420 ft;     FG := 11.445 ft;     JG :=  4.805 ft;
DH := 3.025 ft;     EH :=  3.655 ft;     FH :=  2.415 ft;     JH :=  2.450 ft;
DI := 4.890 ft;     EI := 11.955 ft;     FI :=  4.370 ft;     JI :=  1.040 ft;
DJ := 3.025 ft;     EJ :=  3.740 ft;     FJ :=  4.115 ft;     JJ :=  2.340 ft;
DK := 2.840 ft;     EK :=  1.800 ft;     FK :=  3.405 ft;     JK :=  0.825 ft;
DL := 2.250 ft;     EL :=  6.655 ft;     FL :=  2.450 ft;     JL := 15.975 ft;
DM := 2.615 ft;     EM :=  2.315 ft;     FM :=  0.610 ft;     JM := 12.690 ft;
DN := 3.060 ft;     EN :=  2.450 ft;                          JN :=  6.715 ft;
                    EO :=  0.910 ft;                          JO :=  0.785 ft;
                    EP := 10.590 ft;                          JP :=  4/12 EstFt;
                    EQ :=  3.905 ft;                          JQ :=  8/12 EstFt;
                    ER :=  3.365 ft;                          JR :=  3.785 ft;
                    ES :=  4.885 ft;                          JS :=  7.560 ft;
                    ET :=  7.510 ft;                          JT :=  8.005 ft;
                    EU :=  1.330 ft;
                    EV :=  1.335 ft;

% M A S T E R B A T H --- H A L L B A T H --- B L U E R O O M
GA :=  3.095 ft;          HA := 12.290 ft;    IA := 15.985 ft;
GB :=  4/12 EstFt;        HB :=  7.110 ft;    IB := 10.990 ft;
GC :=  2.415 ft;          HC :=  9.325 ft;    IC :=  1.535 ft;
GD :=  4/12 EstFt;        HD :=  4.815 ft;    ID :=  1.520 ft;
GE :=  6.920 ft;          HE :=  3.170 ft;    IE :=  2.950 ft;
GF :=  2.420 ft;          HF :=  3.095 ft;    IF :=  0.990 ft;
GG :=  2.075 ft;          HG :=  1.270 ft;    IG :=  0.565 ft;
GH :=  9.005 ft;          HH :=  2.925 ft;    IH :=  7.455 ft;
GI :=  4.465 ft;          HI :=  2.260 ft;    II :=  5.895 ft;
GJ :=  0.790 ft;          HJ :=  2.010 ft;    IJ :=  7.025 ft;
GK :=  1.245 ft;          HK :=  2.530 ft;    IK :=  0.560 ft;
GL :=  5.440 ft;          HL :=  ft;          IL :=  0.565 ft;
GM :=  2.000 ft;          HM :=  ft;          IM :=  2.485 ft;
GN := 12.235 ft;          HN :=  0.745 ft;    IN := 13.260 ft;
GO :=  3.020 ft;          HO :=  1.915 ft;          
GP :=  4.880 ft;          HP :=  ft;          
GQ :=  6.830 ft;          HQ :=  2.425 ft;          
GR :=  0.825 ft;          HR :=  6.240 ft;          
GS :=  3.700 ft;          HS = HT-HE-HI;
GT :=  4/12 EstFt;        HT = HF+HH+HG;
GU :=  5.010 ft;
  
% S O U T H H A L L  ---  G A R A G E
KA := 4.955 ft;           LA :=  ft;
KB := 1.030 ft;           LB :=  ft;
KC := 2.415 ft;           LC :=  ft;
KD := 1.215 ft;           LD :=  ft;
KE := 1.915 ft;           LE :=  ft;
KF := 2.495 ft;           LF :=  ft;
KG := 1.595 ft;           LG :=  ft;
                          LH :=  ft;
                          LI :=  ft;
KJ := 0.555 ft;           LJ :=  ft;
                          LK :=  ft;
KL := 0.590 ft;           LL :=  ft;
KM := 9.420 ft;           LM :=  ft;
                          LN :=  ft;
                          LO :=  ft;
                          LP :=  ft;
                          LQ :=  ft;
                          LR :=  ft;
                          LS :=  ft;
                          LT :=  ft;

path garage, livingroom, kitchen, blueroom, master,
     masterclosetwest, mastercloseteast, southbed, southbedcloset,
     masterbathsink, masterbathcloset, masterbathtoilet,
     hallbath, hallbathcloset,
     smallbed, smallbedcloset, laundry, laundrybath, entry, kitchenhallcloset,
     entrycloset, southhallcloset;
garage := (0,0)--(312,0)--(312,330)--(0,330)--cycle;
livingroom := (0,0)--(AN,0)--(AN,AD)--(AN-AI,AD)..(AN-AI-AH/2,AD+AM)..(AN-AI-AH,AD)--(0,AD)--cycle;
kitchen := (0,0)--(E,0)--(E,-J)--(D,-J)--(D,K-J)--(0,K-J)--cycle;
blueroom := (0,0)--(IB,0)--(IB,IA)--(IH,IA)--(IH,IN)--(0,IN)--cycle;
master := (0,0)--(JD,0)--(JD,JA)--(JD-JM,JA)--(JD-JM,JL)--(0,JL)--cycle;
masterclosetwest := (0,0)--(JH,0)--(JH,JT)--(0,JT)--cycle;
mastercloseteast := (0,0)--(JH,0)--(JH,JS)--(0,JS)--cycle;
entry := (0,0)--(BB,0)--(BB,BI)--(BB-BJ,BI)--(BB-BJ,BK)--(BL,BK)--(BL,AD)--(0,AD)--cycle;
laundrybath := (0,0)--(DD,0)--(DD,DJ)--(DD-DH,DJ)--(DG,DI)--(0,DI)--cycle;
laundry := (0,0)--(DD,0)--(DD,J-th)--(0,J-th)--cycle;
kitchenhallcloset := (0,0)--(DL,0)--(DL,DM)--(0,DM)--cycle;
smallbed := (0,0)--(EI,0)--(EI,EF)--(EI+EO,EF)--(EI+EO,EA)--(EM,EA)--(EM,EC)--(0,EC)--cycle;
smallbedcloset := (0,0)--(ET,0)--(ET,EN)--(0,EN)--cycle;
southbed := (0,0)--(FA,0)--(FA,FG)--(0,FG)--cycle;
southbedcloset := (0,0)--(FL,0)--(FL,FF)--(0,FF)--cycle;
entrycloset := (0,0)--(1.8EstFt,0)--(1.8EstFt,6.400ft)--(0,6.4000ft)--cycle;
southhallcloset := (0,0)--(KG,0)--(KG,KF)--(0,KF)--cycle;
masterbathsink := (0,0)--(GE,0)--(GE,GH)--(GF,GH)--(GF,GA)--(0,GA)--cycle;
masterbathcloset := (0,0)--(GM,0)--(GM,GL)--(0,GL)--cycle;
masterbathtoilet := (0,0)--(GP,0)--(GP,GQ)--(0,GQ)--cycle;
hallbath := (0,0)--(GE+th,0)--(GE+th,-2.1EstFt)--(FA,-2.1EstFt)--(FA,5.5EstFt)--(0,5.5EstFt)--cycle;
hallbathcloset := (0,0)--(HK,0)--(HK,HJ)--(0,HJ)--cycle;

livingroom  := livingroom shifted (lrcorner garage + (th,(K-J)+th));
kitchen     := kitchen shifted (lrcorner garage + (th,0));
entry       := entry shifted (lrcorner livingroom + (th,0));
laundry     := laundry shifted (lrcorner garage + (th,-J));
laundrybath := laundrybath shifted (lrcorner garage + (th,-J));
kitchenhallcloset := kitchenhallcloset shifted (lrcorner garage + (th,-DM-th));
smallbed    := smallbed shifted (point 6 of entry + (th,-EC));
smallbedcloset := smallbedcloset shifted (point 1 of smallbed + (-ER-ES-EV,-EN-th));
southbed    := southbed shifted (point 2 of entry + (th,-FH-FM-th-1));
southbedcloset := southbedcloset shifted (point 3 of smallbed + (th,0));  
entrycloset := entrycloset shifted (point 5 of entry + (th,th));
blueroom    := blueroom shifted (lrcorner kitchen + (th,0));
master       := master shifted (point 1 of entry + (-JR,-X-th));
masterclosetwest := masterclosetwest shifted (point 0 of master + (-JH-th,0));
mastercloseteast := mastercloseteast shifted (point 0 of master + (-JH-th,JT+th));
southhallcloset  := southhallcloset shifted (point 4 of entry + (-KG-th,KB+KC+KJ+th));
masterbathsink := masterbathsink shifted (point 3 of master + (th,th));
masterbathcloset := masterbathcloset shifted (point 3 of master + (th,GA+th+th));
masterbathtoilet := masterbathtoilet shifted (point 3 of master + (th+GE+th,th));
hallbath := hallbath shifted (point 3 of masterbathcloset + (0,th));
hallbathcloset := hallbathcloset shifted (point 5 of hallbath + (0,-HJ));

drawwall(garage , th);
drawwall(livingroom, th);
drawwall(kitchen, th);
drawwall(blueroom, th);
drawwall(master, th);
drawwall(masterclosetwest, th);
drawwall(mastercloseteast, th);
drawwall(entry, th);
drawwall(laundry, th);
drawwall(laundrybath, th);
drawwall(kitchenhallcloset, th);
drawwall(smallbed, th);
drawwall(smallbedcloset, th);
drawwall(southbed, th);
drawwall(southbedcloset, th);
drawwall(entrycloset, th);
drawwall(southhallcloset, th);
drawwall(masterbathsink, th);
drawwall(masterbathcloset, th);
drawwall(masterbathtoilet, th);
drawwall(hallbath, th);
drawwall(hallbathcloset, th);
  
% Kitchen floor
draw (point 2 of kitchen shifted (9.990ft,0))--(point 2 of kitchen shifted (9.990ft,K)) withpen pencircle scaled .1bp dashed evenly;

path chimney;
chimney := (0,0)--(D-W-C,0)--(D-W-C,Y)--(0,Y)--cycle;
chimney := chimney shifted (lrcorner garage + (th, 0)) shifted (C,K-J-Y);
fill chimney withpen pencircle scaled .7bp withcolor .7 white;
path hearth;
hearth := (0,0)--(AB,0)--(AB,2)--(0,2)--cycle;
hearth := hearth shifted (point 0 of livingroom) shifted (AA,0);
fill hearth withpen pencircle scaled .7bp withcolor .7 white;

path door[];
door[0]  := doorup    (point 1 of garage, th, 36);      undraw door[0]; % Garage to family
door[1]  := doorup    (point 0 of garage, 5*12, 8*12);  undraw door[1]; % West garage door
door[2]  := doordown  (point 3 of garage, 2*12, 8*12);  undraw door[2]; % East garage door
door[3]  := doorup    (point 1 of livingroom, 49, 72);  undraw door[3]; % Living room to front entry
door[4]  := doorright (point 5 of kitchen, A, B-A); undraw door[4]; % Living to garage entry
door[5]  := doorleft  (point 4 of kitchen, U, V-U); undraw door[5]; % Family to front entry
door[6]  := doorright (point 0 of kitchen, I, H-I); undraw door[6]; % Garage entry closet
door[7]  := doorright (point 0 of kitchen, G, F-G); undraw door[7]; % Laundry room door
door[8]  := doorright (point 2 of kitchen, P, Q-P); undraw door[8]; % Sliding door
door[9]  := doorleft  (point 1 of entry, BH, BD);  undraw door[9]; % Blue room door
door[10] := doorleft  (point 1 of entry, BG-BF, BF);  undraw door[10]; % Master room door
door[11] := doorright (point 5 of entry, BQ, BR);  undraw door[11]; % Understairs closet door
door[12] := doorup    (point 5 of entry, BM, BN);  undraw door[12]; % Entry closet door
door[13] := doorleft  (point 6 of entry, 0.7EstFt, 5.5EstFt); undraw door[13]; % Front entry door
door[14] := doorup    (point 0 of southbed, FM, FH); undraw door[14]; % Door to south bedroom
door[15] := doorup    (point 1 of smallbed, EE, EG); undraw door[15]; % Door to small bedroom
door[16] := doorleft  (point 1 of smallbed, ER, ES); undraw door[16]; % Small room closet
door[17] := doorup    (point 3 of master, JO, JL-JA-JO-JP); undraw door[17]; % Master bath door
% TODO: master bath door width
door[18] := doorup    (point 0 of master, JI, JT-JI-(JJ/2)); undraw door[18]; % Master closet door 1
door[19] := doordown  (point 5 of master, JK, JS-JK-(JJ/2)); undraw door[19]; % Master closet door 2
door[20] := doorright (point 5 of blueroom, IG, II); undraw door[20]; % Blue room closet door
door[21] := doorup    (point 4 of entry, KB+KC+KD, KE); undraw door[21]; % South hall closet door  
door[22] := doorup    (point 4 of entry, KB, KC); undraw door[22]; % Attic door
door[23] := doorup    (point 1 of masterbathsink, GG, GQ-GO-GG); undraw door[23]; % Master bath door to toilet  
door[24] := doorup    (point 1 of masterbathcloset, GK, GL-GJ-GK); undraw door[24]; % Master bath closet door
door[25] := doorleft  (point 1 of hallbathcloset, HN-th, HO); undraw door[25]; % Hall bath closet door
door[26] := doorup    (point 1 of southbedcloset, 1EstFt, 5EstFt); undraw door[26]; % South bed closet door
    
path window[];

window[0] := doorright (point 2 of kitchen,    L, M-L); % Window over sink
window[1] := doorright (point 2 of kitchen,    N, O-N); % Family room picture window
window[2] := doorleft  (point 3 of kitchen,    S, T-S); % Family room big window
drawwindow(window[0], down);
drawwindow(window[1], down);
drawwindow(window[2], down);

% Big rounded window
window[3] := (point 3 of livingroom)..(point 4 of livingroom)..(point 5 of livingroom);
undraw window[3] shortened 3bp;
draw window[3] shortened 1bp shifted (0,3) withpen pencircle scaled .5bp;
draw window[3] shortened 1bp shifted (0,5.5) withpen pencircle scaled .5bp;

window[4] := doorright(point 6 of livingroom, AE, AF-AG);
drawwindow(window[4], up);

window[5] := doorup(point 1 of southbed, FI, FK);
drawwindow(window[5], right);

window[6] := doorleft(point 2 of southbed, FD, FE);
drawwindow(window[6], up);

window[7] := doorleft(point 4 of smallbed, EH, EP-EH-EQ);
drawwindow(window[7], up);

window[8] := doordown(point 5 of smallbed, EJ, EL-EJ);
drawwindow(window[8], left);

window[9] := doorleft(point 1 of master, JF, JD-JG-JF);
drawwindow(window[9], down);

window[10] := doorup(point 1 of master, JC, JA-JB-JC);
drawwindow(window[10], right);

window[11] := doorup(point 1 of masterbathtoilet, GR, GS-GR);
drawwindow(window[11], right);

window[12] := doorup(point 3 of hallbath, HF, HH);
drawwindow(window[12], right);

drawinterior(garage);
drawinterior(livingroom);
drawinterior(kitchen);
drawinterior(entry);
drawinterior(blueroom);
drawinterior(master);
drawinterior(masterclosetwest);
drawinterior(mastercloseteast);
drawinterior(laundry);
drawinterior(smallbed);
drawinterior(smallbedcloset);
drawinterior(southbed);
drawinterior(southbedcloset);
drawinterior(southhallcloset);
drawinterior(masterbathsink);
drawinterior(masterbathcloset);
drawinterior(masterbathtoilet);
drawinterior(hallbath);
drawinterior(hallbathcloset);

drawdimension((point 0 of door[1])--(point 0 of garage), (5,0));
drawdimension((point 0 of door[2])--(point 3 of garage), (10,0));
drawdimension((point 1 of door[1])--(point 1 of door[2]), (5,0));
drawdimension((point 0 of door[4])--(point 1 of door[4]), (0,-5));
drawdimension((point 0 of garage)--(point 3 of garage), (20,0));
drawdimension((point 2 of garage)--(point 3 of garage), (0,-20));

drawdimension((point 5 of kitchen)--(point 4 of kitchen), (0,-15));
drawdimension((point 5 of kitchen)--(point 0 of door[4]), (0,-8));
drawdimension((point 5 of kitchen)--((point 5 of kitchen) + (C,0)), (0,-11));
drawdimension((point 0 of kitchen)--(point 1 of kitchen), (0,8));
drawdimension((point 1 of kitchen)--(point 2 of kitchen), (7,0));
drawdimension((point 3 of kitchen)--(point 4 of kitchen), (-9,0));
drawdimension((point 3 of kitchen)--(point 4 of kitchen), (-9,0));
drawdimension((point 0 of kitchen)--(point 5 of kitchen), (15,0));

drawdimension((point 0 of livingroom)--(point 6 of livingroom), (10,0));
drawdimension((point 6 of livingroom)--(point 2 of livingroom), (0,-15));
drawdimension((point 6 of livingroom)--((point 6 of livingroom)+(AE,0)), (0,-20));
drawdimension((point 6 of livingroom)--((point 6 of livingroom)+(AF,0)), (0,-25));
drawdimension((point 2 of livingroom)--((point 2 of livingroom)-(AI,0)), (0,-25));
drawdimension((point 2 of livingroom)--((point 2 of livingroom)-(0,AJ)), (15,0));
drawdimension((point 1 of livingroom)--((point 1 of livingroom)+(0,AL)), (-7,0));
drawdimension((point 4 of livingroom)--(point 4 of livingroom + (0,-AM)), (9,0));

drawdimension((point 0 of entry)--(point 1 of entry), (0,25));
drawdimension((point 7 of entry)--(point 6 of entry), (0,-15));
drawdimension((point 0 of door[5])--(point 1 of door[5]), (0,9));
drawdimension((point 0 of door[9])--(point 1 of door[9]), (0,4));
drawdimension((point 0 of door[10])--(point 1 of door[10]), (0,4));
drawdimension((point 6 of entry)--(point 6 of entry + (0,-BO)), (-9,0));
drawdimension((point 5 of entry)--(point 5 of entry + (0,-BK)), (0,0));
drawdimension((point 5 of entry)--(point 5 of entry + (3.315ft,0)), (0,-9));
drawdimension((point 5 of entry + (0,1.220ft))--(point 5 of entry + (0,-BK)), (-9,0));
drawdimension((point 0 of door[11])--(point 1 of door[11]), (0,4));
drawdimension((point 4 of entry)--(point 4 of entry + (3.365ft,0)), (0,0));

drawdimension((point 0 of kitchenhallcloset)--(point 1 of kitchenhallcloset), (0,9)); % DL
drawdimension((point 0 of kitchenhallcloset)--(point 3 of kitchenhallcloset), (9,0)); % DM

drawdimension((point 0 of smallbed)--(point 1 of smallbed), (0,9)); % EI
drawdimension((point 4 of smallbed)--(point 5 of smallbed), (0,-9));
drawdimension((point 6 of smallbed)--(point 7 of smallbed), (0,-9)); % EM
drawdimension((point 5 of smallbed)--(point 5 of smallbed + (0,-EA)), (9,0)); % EA

drawdimension((point 0 of southbed)--(point 1 of southbed), (0,9)); % FA
drawdimension((point 1 of southbed)--(point 2 of southbed), (-9,0)); % FG

drawdimension((point 0 of blueroom)--(point 1 of blueroom), (0,9));
drawdimension((point 1 of blueroom)--(point 2 of blueroom), (-9,0));

drawdimension((point 0 of master)--(point 1 of master), (0,9));
drawdimension((point 1 of master)--(point 2 of master), (-9,0));
drawdimension((point 4 of master)--(point 5 of master), (0,-9));
drawdimension((point 0 of master)--(point 5 of master), (9,0));

drawdimension((point 0 of entrycloset)--(point 3 of entrycloset), (9,0));

drawdimension((point 0 of laundry + (0,DI+th))--(point 3 of laundry + (0,-DN)), (9,0));
drawdimension((point 4 of laundrybath)--(point 5 of laundrybath), (0,15));
drawdimension((point 2 of laundrybath)--(point 3 of laundrybath), (0,15));
drawdimension((point 1 of laundrybath)--(point 2 of laundrybath), (-9,0));
drawdimension((point 0 of laundrybath)--(point 5 of laundrybath), (9,0));
drawdimension((point 0 of laundrybath)--(point 1 of laundrybath), (0,9));
drawdimension((point 2 of laundrybath + (0,th))--(point 2 of laundry), (-9,0));
drawdimension((point 2 of laundry)--(point 2 of laundry + (-DB,0)), (0,-9));

drawdimension((point 1 of masterbathtoilet)--(point 2 of masterbathtoilet), (-9,0));
drawdimension((point 3 of hallbath)--(point 4 of hallbath), (-9,0));

%path outline; outline = (0,-50)--(100,-50)--(100,50)--(0,50)--cycle;
%clip currentpicture to outline; draw outline;

%path p;
%p := (point 2 of garage)..(point 3 of garage);
%drawdblarrow p withcolor blue;

picture pic;
pic := thelabel("\title 405 N Wildwood Ln", (180, -50));
unfill bbox pic;
draw pic;


path c;
c = fullcircle scaled 50 shifted (20,-50);
draw c;

def cardinal(expr s, p) = 
picture pic;
pic := thelabel(s, p);
unfill bbox pic; 
draw pic;
enddef;

cardinal("S", point 0 of c);
cardinal("E", point 2 of c);
cardinal("N", point 4 of c);
cardinal("W", point 6 of c);

fill (point 1 of c + (-4,-8))--(point 4 of c + (6,0))--(point 7 of c + (-4,8))--cycle;

%%%%%%% G R I D

path dimensions;
dimensions := (-0.4ft,30ft)--(101.6ft,30ft);
draw dimensions;
for i=0 upto 102:
  if (floor(i mod 10) = 0):
    draw ((i*ft)-0.4ft,30ft)--((i*ft)-0.4ft,29.5ft);
  else:
    draw ((i*ft)-0.4ft,30ft)--((i*ft)-0.4ft,29.75ft);
  fi;
endfor;
picture pic;
pic := thelabel("\bahnlight feet", (.4ft, 31ft));
unfill bbox pic;
draw pic;

%% TODO: Create version of the drawing with everything faded out and just the path
%%       of a single room with each of the points pairs using the dimension ids.


#+end_src


#+begin_src elisp
(fset 'org-babel-copy-current-src
   (kmacro-lambda-form [?\C-r ?# ?+ ?b ?e ?g ?i ?n ?_ ?s ?r ?c ?\C-a down ?\C-  ?\C-s ?# ?+ ?e ?n ?d ?_ ?s ?r ?c ?\C-a ?\M-w] 0 "%d"))
(global-set-key (kbd "<f5>") 'org-babel-copy-current-src)
#+end_src


*** Try out templating to Metapost directly from Python

#+begin_src python :results output
def draw(*args):
    path = '--'.join([f'({x}ft,{y}ft)' for x, y in args])
    print(f'draw {path}--cycle;')

print('ft = 1cm; pickup pensquare scaled 1bp;')
draw((0,0), (26,0), (26,27.5), (0,27.5))
print('pickup pensquare scaled 0.5ft;')

#+end_src

#+RESULTS:
: ft = 1cm; pickup pensquare scaled 1bp;
: draw (0ft,0ft)--(26ft,0ft)--(26ft,27.5ft)--(0ft,27.5ft)--cycle;
: pickup pensquare scaled 0.5ft;

*** Try out templating to Metapost using Jinja templates
  
  
** 

** Build a wall at a time

#+begin_src scad
include <BOSL/constants.scad>
use <BOSL/transforms.scad>

// Living east wall
difference() {
  cube([38, 0.5, 8]);
  right(5) cube([4, 0.5, 7]);
}

// Living north wall
cube([14.5])
#+end_src

